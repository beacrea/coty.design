<script lang="ts">
  import { theme } from '../stores/theme';

  $: isDark = $theme === 'dark';
  
  function handleToggle() {
    theme.toggle();
  }
</script>

<button 
  class="toggle" 
  class:dark={isDark}
  on:click={handleToggle}
  aria-label={isDark ? 'Switch to light mode' : 'Switch to dark mode'}
>
  {#if isDark}
    <svg class="icon moon" viewBox="3 -1 23 24" fill="none" xmlns="http://www.w3.org/2000/svg">
      <path d="M25.182 11.3833C25.0695 13.4667 24.356 15.4729 23.1276 17.1594C21.8993 18.8459 20.2088 20.1405 18.2604 20.8867C16.312 21.633 14.1891 21.7988 12.1485 21.3643C10.1078 20.9298 8.2367 19.9135 6.76131 18.4383C5.28592 16.963 4.26942 15.092 3.8347 13.0514C3.39997 11.0108 3.56563 8.8879 4.31165 6.9395C5.05767 4.991 6.3521 3.3003 8.03849 2.0718C9.72487 0.8433 11.731 0.1296 13.8144 0.0169C14.3004 -0.0095 14.5548 0.5689 14.2968 0.9805C13.4338 2.3612 13.0643 3.9935 13.248 5.6169C13.4317 7.2403 14.1587 8.7565 15.3208 9.9187C16.483 11.0808 17.9992 11.8078 19.6226 11.9915C21.246 12.1752 22.8783 11.8057 24.259 10.9427C24.6706 10.6847 25.2084 10.9391 25.182 11.3833Z" fill="#6366F1" style="fill:color(display-p3 0.3882 0.4000 0.9451);"/>
      <path d="M19.6483 5.8426C18.8672 5.0615 18.8672 3.7952 19.6483 3.0142C20.4293 2.2331 21.6957 2.2331 22.4767 3.0142C23.2578 3.7952 23.2578 5.0615 22.4767 5.8426C21.6957 6.6236 20.4293 6.6236 19.6483 5.8426Z" fill="#C5CAFF" style="fill:color(display-p3 0.7725 0.7922 1.0000);"/>
    </svg>
  {:else}
    <svg class="icon sun" viewBox="0 0 29 28" fill="none" xmlns="http://www.w3.org/2000/svg">
      <path d="M14.4001 19.2C17.0511 19.2 19.2001 17.0509 19.2001 14.4C19.2001 11.749 17.0511 9.59998 14.4001 9.59998C11.7491 9.59998 9.6001 11.749 9.6001 14.4C9.6001 17.0509 11.7491 19.2 14.4001 19.2Z" fill="#FFF1E6" stroke="#F38034" style="fill:color(display-p3 1.0000 0.9451 0.9020);stroke:color(display-p3 0.9549 0.5007 0.2030);" stroke-width="1.5" stroke-linecap="round"/>
      <path d="M14.4004 23.25C14.8144 23.2502 15.1504 23.5859 15.1504 24V26.4004C15.1502 26.8143 14.8143 27.1502 14.4004 27.1504C13.9863 27.1504 13.6506 26.8144 13.6504 26.4004V24C13.6504 23.5858 13.9862 23.25 14.4004 23.25ZM7.07812 20.6621C7.37103 20.3694 7.84584 20.3693 8.13867 20.6621C8.43108 20.955 8.43123 21.4299 8.13867 21.7227L6.44629 23.415C6.15351 23.7074 5.67855 23.7074 5.38574 23.415C5.09297 23.1223 5.09321 22.6474 5.38574 22.3545L7.07812 20.6621ZM20.6621 20.6621C20.955 20.3694 21.4299 20.3693 21.7227 20.6621L23.415 22.3545C23.7076 22.6471 23.7076 23.1221 23.415 23.415C23.1223 23.7078 22.6474 23.7076 22.3545 23.415L20.6621 21.7227C20.3693 21.4299 20.3693 20.955 20.6621 20.6621ZM1.64941 13.6504C2.06362 13.6504 2.39941 13.9862 2.39941 14.4004C2.39941 14.8144 2.06362 15.1504 1.64941 15.1504H0.75C0.335938 15.1504 0 14.8144 0 14.4004C0 13.9862 0.335937 13.6504 0.75 13.6504H1.64941ZM28.0498 13.6504C28.4641 13.6504 28.7998 13.9862 28.7998 14.4004C28.7998 14.8144 28.4641 15.1504 28.0498 15.1504H27.1504C26.7362 15.1504 26.4004 14.8144 26.4004 14.4004C26.4004 13.9862 26.7362 13.6504 27.1504 13.6504H28.0498ZM6.44629 5.38574C6.73869 5.09334 7.21358 5.09334 7.50586 5.38574L8.13867 6.01855C8.43152 6.31141 8.43152 6.78613 8.13867 7.07871C7.84583 7.37154 7.37109 7.37154 7.07812 7.07871L6.44531 6.44531C6.15293 6.15286 6.15293 5.67821 6.44629 5.38574ZM21.7227 5.38574C22.0154 5.09313 22.4901 5.09313 22.7832 5.38574L23.4155 6.01855C23.708 6.31092 23.708 6.78564 23.4155 7.07871C23.1227 7.37111 22.6477 7.37111 22.3545 7.07871L21.7227 6.44629C21.4299 6.15337 21.4299 5.67855 21.7227 5.38574ZM14.4004 1.64941C14.8144 1.64982 15.1502 1.98568 15.1504 2.39941V2.40039L15.1504 3.29883C15.1502 3.71318 14.8143 4.04903 14.4004 4.04883C13.9863 4.04884 13.6506 3.71289 13.6504 3.29883V2.39941C13.6504 1.98528 13.9862 1.64941 14.4004 1.64941Z" fill="#F9A825" style="fill:color(display-p3 0.9765 0.6588 0.1451);"/>
    </svg>
  {/if}
</button>

<style>
  .toggle {
    width: var(--toggle-size);
    height: var(--toggle-size);
    border-radius: 50%;
    border: var(--toggle-border-width) solid var(--toggle-border);
    background: transparent;
    cursor: pointer;
    display: flex;
    align-items: center;
    justify-content: center;
    transition: border-color var(--transition-toggle), transform var(--transition-toggle);
    z-index: 100;
    flex-shrink: 0;
  }

  .toggle:hover {
    transform: scale(1.05);
  }

  .toggle:active {
    transform: scale(0.95);
  }

  .icon {
    width: var(--icon-size);
    height: var(--icon-size);
    transition: transform var(--transition-toggle);
  }

  .sun {
    animation: spin-in 0.3s ease-out;
  }

  .moon {
    animation: fade-in 0.3s ease-out;
  }

  @keyframes spin-in {
    from {
      transform: rotate(-90deg) scale(0.5);
      opacity: 0;
    }
    to {
      transform: rotate(0deg) scale(1);
      opacity: 1;
    }
  }

  @keyframes fade-in {
    from {
      transform: scale(0.5);
      opacity: 0;
    }
    to {
      transform: scale(1);
      opacity: 1;
    }
  }
</style>
